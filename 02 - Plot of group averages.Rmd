---
title: "Superimposing Summary by Group"
author: "Ashwin Malsh√©"
date: "9/11/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
```

Often we need to plot summary statistics for each group on top of the raw data. For this, we need two data sets.

In the following example, I will use mpg data set and plot average of `hwy` on top of a scatterplot. Here the average is NOT by any group and instead it's overall average.

```{r}
hwymean1 <- summarize(mpg, avghwy = mean(hwy))
```

```{r}
print(hwymean1)
```

hline = horizontal line
give y axis to place hline

```{r}
ggplot(mpg, aes(class, hwy)) +
  geom_point() +
  geom_hline(aes(yintercept = avghwy), 
             data = hwymean1, 
             color = "red")

```
23.44017
```{r}
ggplot(mpg, aes(class, hwy)) +
  geom_point() +
  geom_hline(yintercept = 23.44017, 
             color = "red")
```




What if we want to plot average values of each group?

We need to have a data frame of average values of each group. It can be done in a similar fashion as the previous graph. However, the code will be cleaner if we create a data frame separately.

```{r}
hwymean2 <- mpg %>%
            group_by(class) %>%
            summarize(avghwy = mean(hwy)) %>%
            ungroup()
```

class
avghwy

```{r}
ggplot(mpg, aes(class, hwy)) +
  geom_point() +
  geom_point(aes(x = class, y = avghwy),
             data = hwymean2,
             color = "red",
             size = 4,
             alpha = 0.5)
```


Now we can use the same 

```{r}

ggplot(mpg, aes(class, hwy)) +
  geom_point() +
  geom_point(aes(y = avghwy), 
             hwymean2, 
             color = "red", 
             size = 4)

```

Finally, plot the averall mean on the graph as well

```{r}

ggplot(mpg, aes(class, hwy)) +
  geom_point() +
  geom_point(aes(y = avghwy), 
             hwymean2, 
             color = "red", 
             size = 4) +
  geom_text(aes(label = round(avghwy, 2), y = avghwy), 
            data = hwymean2, 
            color = "red", 
            hjust = 1.3) +
  geom_hline(aes(yintercept = avghwy), 
             data = hwymean1, 
             color = "blue") +
  geom_text(aes(x = "compact", y = 22, label = round(avghwy,2)),
            data = hwymean1, 
            color = "blue", 
            hjust = 1.5) 

```

```{r}
hwymean1 <- summarize(mpg, avghwy = mean(hwy),
                      maxhwy = max(hwy),
                      minhwy = min(hwy))
```


```{r}

ggplot(mpg, aes(class, hwy)) +
  geom_point() +
  geom_point(aes(y = avghwy), 
             hwymean2, 
             color = "red", 
             size = 4) +
  geom_text(aes(label = round(avghwy, 2), y = avghwy), 
            data = hwymean2, 
            color = "red", 
            hjust = 1.3) +
  geom_hline(aes(yintercept = avghwy), 
             data = hwymean1, 
             color = "blue") +
  geom_text(aes(x = "compact", y = 22, label = round(avghwy,2)),
            data = hwymean1, 
            color = "blue", 
            hjust = 1.5) +
  geom_point(aes(y = maxhwy),
             hwymean2,
             color = "green",
             size = 4,
             alpha = 0.7) +
  geom_point(aes(y =minhwy),
             hwymean2,
             color = "navy",
             size = 4,
             alpha = 0.7)
```


If you want to make it easier for people to read, perhaps ordering the vehicle class by average hwy will help

```{r}
m1 = inner_join(mpg,hwymean2, by = "class")
m1$class = reorder(m1$class, m1$avghwy)
```


ggplot - geom_point inherits from ggplot, default behavior
```{r}

ggplot(m1, aes(class, hwy)) +
  geom_point() +
  geom_point(aes(y = avghwy), 
             data = hwymean2, 
             color = "red", 
             size = 4,
             alpha = 0.5) +
  geom_text(aes(label = round(avghwy, 2), y = avghwy), 
            data = hwymean2, 
            color = "red", 
            hjust = 1.3) +
  geom_hline(aes(yintercept = avghwy), 
             data = hwymean1, 
             color = "blue") +
  geom_text(aes(x = "compact", y = 22, label = round(avghwy,2)),
            data = hwymean1, 
            color = "blue", 
            hjust = 1.5) 

```
text by default is center justified
hjust = 0.5 is the default value
hjust = 0 is moving the text label (position) to the right
adobe creative cloud suite
Illustrator




